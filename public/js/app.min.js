let app=Vue.createApp({data(){return{images:[],isTableView:!0,isGridView:!1,totalImages:0,totalSize:0,selectedQuality:"0.5",theme:"dark"}},computed:{tableIcon(){return`
    <svg width="20" height="20" viewBox="0 0 0.375 0.375" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 .038A.04.04 0 0 1 .038 0H.1v.1H0zm0 .087v.213a.04.04 0 0 0 .038.037H.1v-.25zm.125.25h.213A.04.04 0 0 0 .376.337V.125H.125zM.375.1V.038A.04.04 0 0 0 .338 0H.125v.1z" fill="var(--bs-primary)"/>
    </svg> <span style="color:var(--bs-primary);font-weight: bold;">TABLE</span>`},gridIcon(){return`
    <svg width="20px" height="20px" viewBox="0 0 0.375 0.375" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M0.038 0A0.038 0.038 0 0 0 0 0.038v0.1A0.038 0.038 0 0 0 0.038 0.175h0.1A0.038 0.038 0 0 0 0.175 0.138v-0.1A0.038 0.038 0 0 0 0.138 0z" fill="var(--bs-primary)"/>
    <path d="M0.238 0A0.038 0.038 0 0 0 0.2 0.038v0.1A0.038 0.038 0 0 0 0.238 0.175h0.1A0.038 0.038 0 0 0 0.375 0.138v-0.1A0.038 0.038 0 0 0 0.338 0z" fill="var(--bs-primary)"/>
    <path d="M0.038 0.2A0.038 0.038 0 0 0 0 0.238v0.1A0.038 0.038 0 0 0 0.038 0.375h0.1A0.038 0.038 0 0 0 0.175 0.338v-0.1A0.038 0.038 0 0 0 0.138 0.2z" fill="var(--bs-primary)"/>
    <path d="M0.238 0.2A0.038 0.038 0 0 0 0.2 0.238v0.1A0.038 0.038 0 0 0 0.238 0.375h0.1a0.038 0.038 0 0 0 0.038 -0.038v-0.1A0.038 0.038 0 0 0 0.338 0.2z" fill="var(--bs-primary)"/>
    </svg> <span style="color:var(--bs-primary);font-weight: bold;">GRID</span>`},totalImages(){return this.images.length},totalSize(){return this.images.reduce((e,t)=>e+parseFloat(t.newSizeMB),0).toFixed(2)}},methods:{preventDefaults(e){e.preventDefault(),e.stopPropagation()},handleFiles(e){Array.from(e).forEach(this.uploadFile)},async uploadFile(e){var t=await this.convertToWebp(e),a=(e.size/1024/1024).toFixed(2),i=(this.getFileSizeFromDataUrl(t)/1024/1024).toFixed(2);this.images.push({name:e.name,originalSize:e.size,webpImage:t,originalSizeMB:a,newSizeMB:i})},async convertToWebp(e){return new Promise(async a=>{let i=new FileReader;i.onloadend=async()=>{var e=await fetch(i.result).then(e=>e.blob()),e=await createImageBitmap(e),t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toBlob(e=>{let t=new FileReader;t.onloadend=()=>a(t.result),t.readAsDataURL(e)},"image/webp",this.selectedQuality)},i.readAsDataURL(e)})},getFileSizeFromDataUrl(e){return this.dataUrlToBlob(e).size},dataUrlToBlob(e){var e=e.split(";base64,"),t=window.atob(e[1]),a=t.length,i=new Uint8Array(a);for(let e=0;e<a;++e)i[e]=t.charCodeAt(e);return new Blob([i],{type:"image/"+this.selectedFormat})},downloadImage(e,t){var a=document.createElement("a");a.href=e,a.download=t.replace(/\.[^/.]+$/,"."+this.selectedFormat),document.body.appendChild(a),a.click(),document.body.removeChild(a)},removeImage(e){this.images.splice(e,1)},toggleView(){this.isTableView=!this.isTableView,this.isGridView=!this.isGridView},toggleTheme(){this.theme="dark"===this.theme?"light":"dark",document.body.setAttribute("data-theme",this.theme),localStorage.setItem("theme",this.theme)},removeInfoBar(){let a=document.querySelector(".info-bar");var e=localStorage.getItem("hideInfoBar");if(e&&Date.now()<parseInt(e,10))a.style.transform="translate(0%, -100%)";else{let t=setTimeout(()=>{a.style.transform="translate(0%, -100%)"},1e4);a.addEventListener("click",()=>{clearTimeout(t),a.style.transform="translate(0%, -100%)";var e=Date.now()+6e5;localStorage.setItem("hideInfoBar",e)})}}},watch:{images:{handler(e){this.totalImages=e.length,this.totalSize=e.reduce((e,t)=>e+parseFloat(t.newSizeMB),0).toFixed(2)},deep:!0}},mounted(){var e=document.createElement("link"),e=(e.rel="stylesheet",e.href="css/style.min.css",document.head.appendChild(e),this.removeInfoBar(),localStorage.getItem("theme"));e&&(this.theme=e,document.body.setAttribute("data-theme",this.theme));let t=document.getElementById("drop-area");document.body.addEventListener("dragenter",e=>{this.preventDefaults(e),t.classList.add("show")},!1),document.body.addEventListener("dragover",this.preventDefaults,!1),document.body.addEventListener("dragleave",e=>{(e.clientX<=0||e.clientY<=0||e.clientX>=window.innerWidth||e.clientY>=window.innerHeight)&&t.classList.remove("show")},!1),document.body.addEventListener("drop",e=>{this.preventDefaults(e),document.getElementById("drop-area").classList.remove("show"),this.handleFiles(e.dataTransfer.files)},!1),document.getElementById("file-input").addEventListener("change",e=>{this.handleFiles(e.target.files)},!1)}});app.mount("#app");